#!/usr/bin/env sh

# OpenVSwitch installation
sudo apt-get -y install graphviz autoconf libtool
wget -q https://github.com/openvswitch/ovs/archive/v2.3.1.tar.gz
tar xfz v2.3.1.tar.gz
rm v2.3.1.tar.gz
cd /home/vagrant/ovs-2.3.1
./boot.sh
./configure
make
sudo make install
cd ..

sudo mkdir -p /usr/local/etc/openvswitch
sudo ovsdb-tool create /usr/local/etc/openvswitch/conf.db vswitchd/vswitch.ovsschema
sudo ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
                  --remote=db:Open_vSwitch,Open_vSwitch,manager_options \
                  --pidfile --detach

sudo ovs-vsctl --no-wait init
sudo ovs-vswitchd --pidfile --detach
